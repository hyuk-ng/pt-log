<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="PT ì¼ì§€">
<title>PT ì¼ì§€ - BODY SPECTRUM</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700;800;900&display=swap');
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Noto Sans KR',sans-serif;background:#e8e8e8;padding:10px;padding-bottom:80px;-webkit-user-select:none;user-select:none;}

/* Member Bar */
.member-bar{max-width:780px;margin:0 auto 8px;background:#1a1a1a;border-radius:12px;padding:10px 16px;display:flex;align-items:center;gap:8px;flex-wrap:wrap;}
.member-bar label{color:#00d4aa;font-size:12px;font-weight:700;letter-spacing:1px;}
.member-select{padding:6px 12px;border-radius:6px;border:1px solid #444;background:#2a2a2a;color:white;font-size:13px;font-weight:700;font-family:'Noto Sans KR',sans-serif;outline:none;cursor:pointer;min-width:140px;}
.member-select:focus{border-color:#00d4aa;}
.mb{padding:5px 10px;border-radius:6px;border:1px solid #444;background:transparent;color:#ccc;font-size:11px;font-weight:600;cursor:pointer;font-family:'Noto Sans KR',sans-serif;}
.mb:hover{background:#00d4aa;color:#1a1a1a;border-color:#00d4aa;}
.mb.active{background:#00d4aa;color:#1a1a1a;border-color:#00d4aa;}
.member-status{font-size:11px;color:#666;margin-left:auto;}

/* Member Search */
.member-search{width:100%;padding:6px 12px;border-radius:6px;border:1px solid #444;background:#2a2a2a;color:white;font-size:13px;font-weight:600;font-family:'Noto Sans KR',sans-serif;outline:none;}
.member-search:focus{border-color:#00d4aa;}
.member-search::placeholder{color:#777;}
.member-dropdown{position:absolute;top:100%;left:0;right:0;background:#2a2a2a;border:1px solid #444;border-top:none;border-radius:0 0 6px 6px;max-height:200px;overflow-y:auto;z-index:600;display:none;}
.member-dropdown.show{display:block;}
.member-item{padding:8px 12px;color:#ccc;font-size:13px;font-weight:600;cursor:pointer;display:flex;justify-content:space-between;align-items:center;}
.member-item:hover{background:#00d4aa;color:#1a1a1a;}
.member-item .mi-sessions{font-size:10px;color:#888;font-weight:400;}
.member-item:hover .mi-sessions{color:#1a1a1a;}

/* History Bar */
.history-bar{max-width:780px;margin:0 auto 8px;background:#2d2d2d;border-radius:10px;padding:8px 16px;display:none;align-items:center;gap:6px;overflow-x:auto;-webkit-overflow-scrolling:touch;}
.history-bar.show{display:flex;}
.hist-chip{padding:5px 12px;border-radius:16px;border:1px solid #555;background:transparent;color:#aaa;font-size:11px;font-weight:600;cursor:pointer;font-family:'Noto Sans KR',sans-serif;white-space:nowrap;transition:all 0.15s;}
.hist-chip:hover,.hist-chip.active{background:#4CAF50;color:white;border-color:#4CAF50;}
.hist-label{color:#888;font-size:11px;font-weight:600;margin-right:4px;white-space:nowrap;}

.sheet{max-width:780px;margin:0 auto;background:white;padding:28px 30px 20px;box-shadow:0 2px 20px rgba(0,0,0,0.1);}
.header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px;}
.header h1{font-size:32px;font-weight:900;color:#1a1a1a;letter-spacing:-1px;}
.logo{font-size:14px;font-weight:800;color:#1a1a1a;display:flex;align-items:center;gap:6px;}
.logo-icon{width:22px;height:22px;background:#1a1a1a;border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-size:11px;font-weight:900;}
.session-grid{display:flex;flex-wrap:wrap;gap:0;margin-bottom:10px;}
.session-num{width:35px;height:26px;border:1px solid #ccc;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:600;color:#555;margin-right:-1px;margin-bottom:-1px;cursor:pointer;background:transparent;}
.session-num.marked{background:#e0e0e0;color:#333;font-weight:800;}
.memo-box{border:1px solid #ccc;min-height:45px;margin-bottom:10px;padding:8px;font-size:13px;color:#333;outline:none;}
.info-table{width:100%;border-collapse:collapse;margin-bottom:10px;font-size:13px;}
.info-table td{border:1px solid #ccc;padding:6px 10px;vertical-align:middle;}
.info-table .lc{background:#f5f5f5;font-weight:700;color:#333;width:85px;text-align:center;font-size:12px;}
.info-table .vc{min-width:100px;color:#333;outline:none;}
.info-table .bp{font-size:11px;line-height:1.8;color:#555;}
.hydration-row{display:flex;gap:4px;}
.h-dot{width:20px;height:20px;border-radius:50%;border:2px solid #b0d4f1;cursor:pointer;transition:all 0.15s;}
.h-dot.filled{background:#64b5f6;border-color:#42a5f5;}
.tp-selector{display:flex;align-items:center;gap:8px;margin-bottom:8px;flex-wrap:wrap;}
.tp-selector label{font-size:12px;font-weight:700;color:#333;}
.tp-select{padding:6px 12px;border:2px solid #1a1a1a;border-radius:6px;font-size:13px;font-weight:700;font-family:'Noto Sans KR',sans-serif;background:white;color:#1a1a1a;outline:none;cursor:pointer;max-width:300px;}
.tp-exercise-name{font-size:11px;color:#888;margin-left:4px;}
.tp-header{background:#1a1a1a;color:white;text-align:center;padding:8px;font-size:16px;font-weight:800;letter-spacing:3px;}
.tp-photos-wrap{display:grid;grid-template-columns:1fr 1fr;gap:0;border:1px solid #ccc;border-top:none;}
.tp-panel{position:relative;overflow:hidden;min-height:180px;background:#f5f5f5;touch-action:none;}
.tp-panel:first-child{border-right:1px solid #ccc;}
.tp-panel img{width:100%;display:block;pointer-events:none;user-select:none;-webkit-user-drag:none;}
.tp-panel-label{position:absolute;top:6px;left:6px;background:rgba(0,0,0,0.65);color:white;font-size:10px;font-weight:700;letter-spacing:1px;padding:3px 10px;border-radius:3px;z-index:30;pointer-events:none;}
/* Photo remove button */
.photo-remove{position:absolute;top:6px;right:6px;width:26px;height:26px;border-radius:50%;background:rgba(0,0,0,0.6);border:none;color:white;font-size:14px;cursor:pointer;z-index:30;display:none;align-items:center;justify-content:center;line-height:1;}
.photo-remove.show{display:flex;}
.photo-remove:hover{background:#e53935;}
.tp-upload-btn{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.06);border:2px dashed #bbb;border-radius:12px;padding:24px 18px;text-align:center;cursor:pointer;color:#999;font-size:13px;z-index:5;}
.tp-upload-btn:hover{border-color:#666;color:#666;}
.tp-upload-btn .icon{font-size:28px;margin-bottom:4px;}
.ann{position:absolute;background:rgba(255,255,255,0.92);border:2px solid;border-radius:4px;padding:3px 7px;font-size:11px;font-weight:700;cursor:grab;white-space:nowrap;z-index:20;box-shadow:1px 1px 4px rgba(0,0,0,0.15);touch-action:none;line-height:1.4;display:flex;align-items:center;gap:3px;}
.ann:active{cursor:grabbing;}
.ann .n{display:inline-flex;width:17px;height:17px;border-radius:50%;align-items:center;justify-content:center;font-size:10px;font-weight:800;color:white;flex-shrink:0;}
.ann .del-ann{display:none;width:15px;height:15px;border-radius:50%;border:none;background:rgba(0,0,0,0.15);color:#888;font-size:9px;cursor:pointer;align-items:center;justify-content:center;margin-left:2px;flex-shrink:0;}
.ann:hover .del-ann{display:inline-flex;}
.ann .del-ann:hover{background:#e53935;color:white;}
.dot{position:absolute;width:10px;height:10px;border-radius:50%;border:2px solid white;cursor:grab;z-index:15;transform:translate(-50%,-50%);touch-action:none;box-shadow:0 0 4px rgba(0,0,0,0.3);}
.dot:active{cursor:grabbing;}
.tp-svg{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:10;}
.cues{margin-top:8px;padding:8px 10px;background:#fafafa;border:1px solid #e0e0e0;border-radius:4px;}
.cues-t{font-size:11px;font-weight:800;letter-spacing:2px;color:#e53935;margin-bottom:5px;}
.cues-sub-row{display:flex;align-items:center;justify-content:space-between;margin-top:6px;margin-bottom:3px;}
.cues-sub{font-size:10px;font-weight:600;}
.add-cue-btn{font-size:10px;padding:2px 8px;border:1px solid #ccc;border-radius:4px;background:white;color:#555;cursor:pointer;font-family:'Noto Sans KR',sans-serif;font-weight:600;}
.add-cue-btn:hover{background:#e53935;color:white;border-color:#e53935;}
.cue{display:flex;align-items:center;gap:6px;margin-bottom:3px;font-size:11px;color:#444;line-height:1.5;}
.cue .cn{width:17px;height:17px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:800;color:white;flex-shrink:0;}
.cue-text{flex:1;outline:none;border:none;background:transparent;font-size:11px;color:#444;font-family:'Noto Sans KR',sans-serif;font-weight:500;border-bottom:1px solid transparent;padding:1px 2px;}
.cue-text:focus{border-bottom-color:#e53935;background:#fff8f8;}
.cue-del{width:16px;height:16px;border:none;border-radius:50%;background:transparent;color:#ccc;font-size:10px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;}
.cue-del:hover{background:#e53935;color:white;}
.ex-table{width:100%;border-collapse:collapse;margin-top:10px;font-size:13px;}
.ex-table th{background:#1a1a1a;color:white;padding:7px 10px;font-weight:700;font-size:12px;letter-spacing:1px;border:1px solid #1a1a1a;}
.ex-table td{border:1px solid #ccc;padding:8px 10px;height:34px;outline:none;color:#333;}
.toolbar{position:fixed;bottom:14px;left:50%;transform:translateX(-50%);display:flex;gap:6px;background:rgba(30,30,30,0.95);padding:8px 12px;border-radius:14px;box-shadow:0 4px 24px rgba(0,0,0,0.4);z-index:500;flex-wrap:wrap;justify-content:center;}
.tb{padding:7px 12px;border-radius:8px;border:1px solid #444;background:transparent;color:white;font-size:11px;font-weight:600;font-family:'Noto Sans KR',sans-serif;cursor:pointer;white-space:nowrap;transition:all 0.2s;}
.tb:hover{background:#00d4aa;color:#111;border-color:#00d4aa;}
.tb.save-btn{background:#4CAF50;color:white;border-color:#4CAF50;}
.tb.save-btn:hover{background:#388E3C;}
.tb.cap{background:#00d4aa;color:#111;border-color:#00d4aa;}
.tb.new-btn{background:#FF9800;color:white;border-color:#FF9800;}
.tb.new-btn:hover{background:#F57C00;}
.tb.saving{background:#ffa502;color:#111;border-color:#ffa502;pointer-events:none;}
body.capture .toolbar{display:none!important;}
body.capture .dot{display:none!important;}
body.capture .ann{cursor:default!important;}
body.capture .ann .del-ann{display:none!important;}
body.capture .tp-upload-btn{display:none!important;}
body.capture .tp-selector{display:none!important;}
body.capture .add-cue-btn{display:none!important;}
body.capture .cue-del{display:none!important;}
body.capture .cue-text{border-bottom-color:transparent!important;background:transparent!important;}
body.capture .member-bar{display:none!important;}
body.capture .history-bar{display:none!important;}
body.capture .photo-remove{display:none!important;}
/* Modal */
.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);z-index:8000;display:none;align-items:center;justify-content:center;backdrop-filter:blur(4px);}
.modal-overlay.show{display:flex;}
.modal-box{background:white;border-radius:16px;padding:24px;width:320px;box-shadow:0 10px 40px rgba(0,0,0,0.3);}
.modal-title{font-size:16px;font-weight:800;color:#1a1a1a;margin-bottom:12px;}
.modal-input{width:100%;padding:12px 14px;border:2px solid #ddd;border-radius:10px;font-size:15px;font-family:'Noto Sans KR',sans-serif;font-weight:600;outline:none;margin-bottom:14px;}
.modal-input:focus{border-color:#00d4aa;}
.modal-btns{display:flex;gap:8px;justify-content:flex-end;}
.modal-btn{padding:10px 20px;border-radius:10px;border:none;font-size:13px;font-weight:700;font-family:'Noto Sans KR',sans-serif;cursor:pointer;}
.modal-btn.cancel{background:#f0f0f0;color:#666;}
.modal-btn.ok{background:#00d4aa;color:#111;}
.modal-btn.ok:hover{background:#00b894;}

.toast{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.85);color:white;padding:16px 28px;border-radius:14px;font-size:15px;font-weight:600;z-index:9999;display:none;text-align:center;backdrop-filter:blur(10px);}
.toast.show{display:block;animation:fadeInOut 2.5s ease;}
@keyframes fadeInOut{0%{opacity:0;transform:translate(-50%,-50%) scale(0.9);}15%{opacity:1;transform:translate(-50%,-50%) scale(1);}75%{opacity:1;}100%{opacity:0;}}
</style>
</head>
<body>
<div class="toast" id="toast"></div>

<!-- Custom Modal -->
<div class="modal-overlay" id="modal">
  <div class="modal-box">
    <div class="modal-title" id="modalTitle">ìƒˆ íšŒì› ë“±ë¡</div>
    <input class="modal-input" id="modalInput" placeholder="íšŒì› ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" autocomplete="off" onkeydown="if(event.key==='Enter')modalConfirm()"/>
    <div class="modal-btns">
      <button class="modal-btn cancel" onclick="closeModal()">ì·¨ì†Œ</button>
      <button class="modal-btn ok" id="modalOk" onclick="modalConfirm()">ë“±ë¡</button>
    </div>
  </div>
</div>

<!-- Confirm Modal -->
<div class="modal-overlay" id="confirmModal">
  <div class="modal-box">
    <div class="modal-title">ğŸ“„ ìƒˆ ì¼ì§€ ë§Œë“¤ê¸°</div>
    <p style="font-size:13px;color:#666;margin-bottom:16px;">í˜„ì¬ ì¼ì§€ë¥¼ ì´ˆê¸°í™”í•˜ê³  ìƒˆ ì¼ì§€ë¥¼ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
    <div class="modal-btns">
      <button class="modal-btn cancel" onclick="closeConfirm()">ì·¨ì†Œ</button>
      <button class="modal-btn ok" onclick="confirmNewPage()">ìƒˆ ì¼ì§€ ì‹œì‘</button>
    </div>
  </div>
</div>

<div class="member-bar" id="memberBar">
  <label>ğŸ‘¤</label>
  <div style="position:relative;flex:1;min-width:160px;max-width:280px;">
    <input class="member-search" id="memberSearch" placeholder="íšŒì› ê²€ìƒ‰..." oninput="filterMembers()" onfocus="showMemberDropdown()" autocomplete="off"/>
    <div class="member-dropdown" id="memberDropdown"></div>
  </div>
  <input type="hidden" id="selectedMember" value=""/>
  <button class="mb" onclick="promptAddMember()">ï¼‹ ìƒˆ íšŒì›</button>
  <button class="mb" id="delMemberBtn" onclick="promptDeleteMember()" style="display:none;color:#ff6b6b;border-color:#ff6b6b;">ğŸ—‘ íšŒì›ì‚­ì œ</button>
  <button class="mb" onclick="refreshMembers()" title="ë¶ˆëŸ¬ì˜¤ê¸°">ğŸ“¥ ë¶ˆëŸ¬ì˜¤ê¸°</button>
  <span class="member-status" id="memberStatus"></span>
</div>

<div class="history-bar" id="historyBar">
  <span class="hist-label">ğŸ“‹ ì¼ì§€:</span>
  <div id="histList" style="display:flex;gap:6px;overflow-x:auto;flex:1;"></div>
</div>

<div class="sheet" id="sheet">
  <div class="header"><h1>PT ì¼ì§€</h1><div class="logo"><div class="logo-icon">B</div>BODY SPECTRUM</div></div>
  <div class="session-grid" id="sg"></div>
  <div class="memo-box" contenteditable="true" id="memoBox"></div>
  <table class="info-table">
    <tr><td class="lc">DATE</td><td class="vc" contenteditable="true" id="dateCell" style="font-weight:700;font-size:18px;"></td><td class="lc">HYDRATION</td><td class="vc"><div class="hydration-row" id="hr"></div></td></tr>
    <tr><td class="lc">SLEEP</td><td class="vc" contenteditable="true" id="sleepCell"></td><td class="lc">SUPPLEMENT</td><td class="vc" contenteditable="true" id="suppCell"></td></tr>
    <tr><td class="lc">BODY<br>PART</td><td class="bp" id="bpCell"><label><input type="checkbox"> CARDIO</label>&nbsp;<label><input type="checkbox"> FULL BODY</label>&nbsp;<label><input type="checkbox"> CORE</label><br><label><input type="checkbox"> ARMS</label>&nbsp;<label><input type="checkbox"> BACK</label>&nbsp;<label><input type="checkbox"> CHEST</label><br><label><input type="checkbox"> LEGS</label>&nbsp;<label><input type="checkbox"> SHOULDERS</label>&nbsp;<label><input type="checkbox"> OTHER</label></td><td class="lc">WARM-UP</td><td class="vc" contenteditable="true" id="warmupCell"></td></tr>
    <tr><td colspan="2"></td><td class="lc">COOL DOWN</td><td class="vc" contenteditable="true" id="cooldownCell"></td></tr>
  </table>
  <div class="tp-selector">
    <label>ğŸ¯ ìš´ë™ ì„ íƒ:</label>
    <select class="tp-select" id="exSelect" onchange="onSelectExercise()"><option value="">-- ìš´ë™ì„ ì„ íƒí•˜ì„¸ìš” --</option></select>
    <span class="tp-exercise-name" id="exNameEn"></span>
  </div>
  <div class="tp-header">TEACHING POINT</div>
  <div class="tp-photos-wrap">
    <div class="tp-panel" id="panelL">
      <div class="tp-panel-label">START POSITION</div>
      <button class="photo-remove" id="rmL" onclick="removePhoto('L')">âœ•</button>
      <img id="imgL" style="display:none;"/>
      <div class="tp-upload-btn" id="uplL" onclick="document.getElementById('fileL').click()"><div class="icon">ğŸ“·</div>ì‹œì‘ ìì„¸<input type="file" id="fileL" accept="image/*" style="display:none" onchange="loadImg('L',event)"></div>
      <svg class="tp-svg" id="svgL"></svg>
    </div>
    <div class="tp-panel" id="panelR">
      <div class="tp-panel-label">EXECUTION</div>
      <button class="photo-remove" id="rmR" onclick="removePhoto('R')">âœ•</button>
      <img id="imgR" style="display:none;"/>
      <div class="tp-upload-btn" id="uplR" onclick="document.getElementById('fileR').click()"><div class="icon">ğŸ“·</div>ìˆ˜í–‰ ìì„¸<input type="file" id="fileR" accept="image/*" style="display:none" onchange="loadImg('R',event)"></div>
      <svg class="tp-svg" id="svgR"></svg>
    </div>
  </div>
  <div class="cues" id="cues" style="display:none;"><div class="cues-t">KEY FORM CUES</div><div id="cuesContent"></div></div>
  <table class="ex-table">
    <thead><tr><th style="width:42%">NAME</th><th style="width:22%">Kg</th><th style="width:36%">SET/REPS</th></tr></thead>
    <tbody id="exB"><tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr><tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr><tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr><tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr><tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr><tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr></tbody>
  </table>
</div>

<div class="toolbar" id="toolbar">
  <button class="tb" onclick="addExRow()">ï¼‹ ìš´ë™</button>
  <button class="tb new-btn" onclick="newPage()">ğŸ“„ ìƒˆ ì¼ì§€</button>
  <button class="tb save-btn" id="saveBtn" onclick="saveToSheet()">ğŸ’¾ ì €ì¥</button>
  <button class="tb cap" id="capBtn" onclick="captureAndSave()">ğŸ“¸ ìº¡ì²˜</button>
</div>

<script>
const API_URL='https://script.google.com/macros/s/AKfycbxqRTS49BJSImR5ybOY7F4LdURzPoQID0fnF0JOCyo7e-pnm2xUf45HBL8u3PISV2zCDw/exec';

// Exercise DB
const DB={'ë°”ë²¨ í”Œë« ë²¤ì¹˜í”„ë ˆìŠ¤':{en:'Barbell Flat Bench Press',cat:'ê°€ìŠ´',start:['ê²¬ê°‘ê³¨(ì–´ê¹¨ë¼ˆ)ì„ ëª¨ì•„ ì•„ë˜ë¡œ ë‹¹ê¸´ë‹¤','ê°€ìŠ´ì„ í™œì§ í´ê³  ì•„ì¹˜ë¥¼ ë§Œë“ ë‹¤','ë°œë°”ë‹¥ì„ ë°”ë‹¥ì— ë‹¨ë‹¨íˆ ê³ ì •í•œë‹¤','ê·¸ë¦½ì€ ì–´ê¹¨ ë„ˆë¹„ì˜ ì•½ 1.5ë°°'],exec:['ë°”ë¥¼ ê°€ìŠ´ ì¤‘ì•™(ìœ ë‘ ë¼ì¸)ìœ¼ë¡œ ë‚´ë¦°ë‹¤','íŒ”ê¿ˆì¹˜ ê°ë„ ì•½ 75ë„ ìœ ì§€','ê°€ìŠ´ ìˆ˜ì¶•ì„ ëŠë¼ë©° ë°€ì–´ ì˜¬ë¦°ë‹¤','ì—‰ë©ì´ê°€ ë²¤ì¹˜ì—ì„œ ëœ¨ì§€ ì•Šë„ë¡!']},'ë°”ë²¨ ì¸í´ë¼ì¸ ë²¤ì¹˜í”„ë ˆìŠ¤':{en:'Barbell Incline Bench Press',cat:'ê°€ìŠ´',start:['ë²¤ì¹˜ ê°ë„ 30~45ë„ë¡œ ì„¤ì •','ê²¬ê°‘ê³¨ì„ ëª¨ìœ¼ê³  ë“±ì„ ë°€ì°©ì‹œí‚¨ë‹¤','ê·¸ë¦½ì€ ì–´ê¹¨ë³´ë‹¤ ì•½ê°„ ë„“ê²Œ','ë°œë°”ë‹¥ì„ ë°”ë‹¥ì— ê³ ì •í•œë‹¤'],exec:['ë°”ë¥¼ ì‡„ê³¨ê³¼ ìœ ë‘ ì‚¬ì´ë¡œ ë‚´ë¦°ë‹¤','íŒ”ê¿ˆì¹˜ê°€ ê³¼ë„í•˜ê²Œ ë²Œì–´ì§€ì§€ ì•Šê²Œ','ìƒë¶€ ê°€ìŠ´ ìˆ˜ì¶•ì„ ëŠë¼ë©° ì˜¬ë¦°ë‹¤','ì†ëª©ì´ êº¾ì´ì§€ ì•Šë„ë¡ ì£¼ì˜']},'ë¤ë²¨ í”Œë« ë²¤ì¹˜í”„ë ˆìŠ¤':{en:'Dumbbell Flat Bench Press',cat:'ê°€ìŠ´',start:['ê²¬ê°‘ê³¨ì„ ëª¨ìœ¼ê³  ê°€ìŠ´ì„ í¸ë‹¤','ë¤ë²¨ì„ ê°€ìŠ´ ìœ„ì—ì„œ íŒ”ì„ í´ì„œ ì‹œì‘','ë°œë°”ë‹¥ì„ ë°”ë‹¥ì— ë‹¨ë‹¨íˆ ê³ ì •','ì†ëª©ì€ ì¤‘ë¦½ ìœ ì§€'],exec:['ë¤ë²¨ì„ ê°€ìŠ´ ì–‘ì˜†ìœ¼ë¡œ ì²œì²œíˆ ë‚´ë¦°ë‹¤','íŒ”ê¿ˆì¹˜ ì•½ 75ë„ ìœ ì§€','ê°€ìŠ´ ìˆ˜ì¶•ìœ¼ë¡œ ìœ„ë¡œ ë°€ì–´ ì˜¬ë¦°ë‹¤','ìƒë‹¨ì—ì„œ ë¤ë²¨ì„ ì‚´ì§ ëª¨ì•„ì¤€ë‹¤']},'ë¤ë²¨ í”Œë¼ì´':{en:'Dumbbell Fly',cat:'ê°€ìŠ´',start:['ë²¤ì¹˜ì— ëˆ„ì›Œ ë¤ë²¨ì„ ê°€ìŠ´ ìœ„ë¡œ ë“ ë‹¤','íŒ”ê¿ˆì¹˜ë¥¼ ì‚´ì§ êµ¬ë¶€ë¦° ìƒíƒœ ìœ ì§€','ê²¬ê°‘ê³¨ì„ ëª¨ìœ¼ê³  ê°€ìŠ´ì„ í¸ë‹¤','ë°œë°”ë‹¥ ë°”ë‹¥ì— ê³ ì •'],exec:['í° ë‚˜ë¬´ë¥¼ ì•ˆë“¯ í˜¸ ëª¨ì–‘ ê¶¤ì  ìœ ì§€','ê°€ìŠ´ ë†’ì´ê¹Œì§€ ì–‘íŒ”ì„ ë²Œë¦°ë‹¤','ê°€ìŠ´ ìŠ¤íŠ¸ë ˆì¹­ì„ ëŠë¼ê³  ìˆ˜ì¶•ìœ¼ë¡œ ëª¨ì€ë‹¤','íŒ”ê¿ˆì¹˜ ê°ë„ë¥¼ ì¼ì •í•˜ê²Œ ìœ ì§€!']},'í™ë± í”Œë¼ì´ ë¨¸ì‹ ':{en:'Pec Deck Fly',cat:'ê°€ìŠ´',start:['ë“±ì„ íŒ¨ë“œì— ë°€ì°©ì‹œí‚¨ë‹¤','ì‹œíŠ¸ ë†’ì´: ì†ì¡ì´ê°€ ê°€ìŠ´ ì¤‘ì•™ ë†’ì´','ê°€ìŠ´ì„ í´ê³  ì–´ê¹¨ê°€ ë§ë¦¬ì§€ ì•Šê²Œ','ë°œì„ ë°”ë‹¥ì— ì•ˆì •ì ìœ¼ë¡œ ë†“ëŠ”ë‹¤'],exec:['ê°€ìŠ´ ìˆ˜ì¶•ìœ¼ë¡œ ì–‘íŒ”ì„ ê°€ìš´ë°ë¡œ ëª¨ì€ë‹¤','ìµœëŒ€ ìˆ˜ì¶• ì§€ì ì—ì„œ 1~2ì´ˆ ë²„í‹´ë‹¤','ì²œì²œíˆ ë²Œë¦¬ë©° ê°€ìŠ´ ìŠ¤íŠ¸ë ˆì¹­','ì–´ê¹¨ê°€ ì•ìœ¼ë¡œ ë§ë¦¬ì§€ ì•Šë„ë¡ ì£¼ì˜']},'ì¼€ì´ë¸” í¬ë¡œìŠ¤ì˜¤ë²„':{en:'Cable Crossover',cat:'ê°€ìŠ´',start:['ì–‘ìª½ ì¼€ì´ë¸”ì„ ë†’ì€ ìœ„ì¹˜ì— ì„¤ì •','í•œ ë°œì„ ì•ìœ¼ë¡œ ë‚´ë”›ì–´ ì•ˆì •ìì„¸','ì•½ê°„ ì•ìœ¼ë¡œ ê¸°ìš¸ì¸ë‹¤','íŒ”ê¿ˆì¹˜ë¥¼ ì‚´ì§ êµ¬ë¶€ë¦°ë‹¤'],exec:['ì–‘ ì†ì¡ì´ë¥¼ ì•„ë˜ ì•ìª½ìœ¼ë¡œ ëª¨ì€ë‹¤','ì†ì´ ë§Œë‚˜ëŠ” ì§€ì ì—ì„œ 1~2ì´ˆ ìˆ˜ì¶•','ì²œì²œíˆ ì›ë˜ ìœ„ì¹˜ë¡œ ëŒì•„ê°„ë‹¤','í’€ë¦¬ ë†’ì´ë¡œ ìê·¹ ë¶€ìœ„ ì¡°ì ˆ ê°€ëŠ¥']},'ë”¥ìŠ¤':{en:'Dips (Chest)',cat:'ê°€ìŠ´',start:['ë”¥ìŠ¤ë°”ë¥¼ ì¡ê³  íŒ”ì„ í´ì„œ ëª¸ì„ ë“ ë‹¤','ìƒì²´ë¥¼ ì•½ 30ë„ ì•ìœ¼ë¡œ ê¸°ìš¸ì¸ë‹¤','ì½”ì–´ì— í˜ì„ ì¤€ë‹¤','ì–´ê¹¨ë¥¼ ì•„ë˜ë¡œ ë‚´ë ¤ ì•ˆì •ì‹œí‚¨ë‹¤'],exec:['íŒ”ê¿ˆì¹˜ë¥¼ êµ¬ë¶€ë¦¬ë©° ì²œì²œíˆ ë‚´ë¦°ë‹¤','íŒ”ê¿ˆì¹˜ 90ë„ê°€ ë ë•Œê¹Œì§€ ë‚´ë¦°ë‹¤','ê°€ìŠ´ í•˜ë¶€ ìˆ˜ì¶•ì„ ëŠë¼ë©° ì˜¬ë¦°ë‹¤','ìƒì²´ë¥¼ ì„¸ìš°ë©´ ì‚¼ë‘ ìš´ë™ì´ ë¨ ì£¼ì˜!']},'ë°”ë²¨ ë²¤íŠ¸ì˜¤ë²„ ë¡œìš°':{en:'Barbell Bent-Over Row',cat:'ë“±',start:['ìƒì²´ë¥¼ ì•½ 45ë„ë¡œ ìˆ™ì¸ë‹¤','í—ˆë¦¬ë¥¼ ê³§ê²Œ ìœ ì§€ (ì¤‘ë¦½ ì²™ì¶”)','ë¬´ë¦ì„ ì‚´ì§ êµ¬ë¶€ë¦°ë‹¤','ê·¸ë¦½ì€ ì–´ê¹¨ ë„ˆë¹„ë¡œ ì¡ëŠ”ë‹¤'],exec:['ë°”ë¥¼ ë°°ê¼½ ë°©í–¥ìœ¼ë¡œ ë‹¹ê¸´ë‹¤','ê²¬ê°‘ê³¨ì„ ëª¨ìœ¼ë©° ìˆ˜ì¶•í•œë‹¤','íŒ”ê¿ˆì¹˜ë¥¼ ë’¤ë¡œ ë³´ë‚¸ë‹¤','ìƒì²´ ê°ë„ë¥¼ ì¼ì •í•˜ê²Œ ìœ ì§€!']},'T-ë°” ë¡œìš°':{en:'T-Bar Row',cat:'ë“±',start:['ì‹œì„ ì€ ì „ë°© ë°”ë‹¥ ì•½ 2m ì‘ì‹œ','í—ˆë¦¬ë¥¼ ê³§ê²Œ ìœ ì§€ (ì¤‘ë¦½ ì²™ì¶”)','ìƒì²´ë¥¼ ì•½ 45ë„ë¡œ ìˆ™ì—¬ ê³ ì •','ë¬´ë¦ ì‚´ì§ êµ½í˜€ í•˜ì²´ë¥¼ ê³ ì •'],exec:['ê²¬ê°‘ê³¨ì„ ëª¨ìœ¼ë©° íŒ”ê¿ˆì¹˜ë¥¼ ë’¤ë¡œ ë‹¹ê¸´ë‹¤','ë°”ë¥¼ ë°°ê¼½(ëª…ì¹˜) ë°©í–¥ìœ¼ë¡œ ë‹¹ê¸´ë‹¤','ì½”ì–´ ê¸´ì¥ ìœ ì§€, ë°˜ë™ ê¸ˆì§€!','ì²œì²œíˆ ë‚´ë¦¬ë©° ê´‘ë°°ê·¼ ìŠ¤íŠ¸ë ˆì¹­']},'ì›ì•” ë¤ë²¨ ë¡œìš°':{en:'One-Arm Dumbbell Row',cat:'ë“±',start:['í•œ ì†ê³¼ ê°™ì€ ìª½ ë¬´ë¦ì„ ë²¤ì¹˜ì— ì˜¬ë¦°ë‹¤','í—ˆë¦¬ë¥¼ ê³§ê²Œ, ë“±ì€ ë°”ë‹¥ê³¼ í‰í–‰','ë°˜ëŒ€ ì†ìœ¼ë¡œ ë¤ë²¨ì„ ì¡ê³  íŒ”ì„ ëŠ˜ì–´ëœ¨ë¦°ë‹¤','ì½”ì–´ì— í˜ì„ ì£¼ì–´ ìƒì²´ íšŒì „ ë°©ì§€'],exec:['íŒ”ê¿ˆì¹˜ë¥¼ ì²œì¥ìœ¼ë¡œ ì˜¬ë¦°ë‹¤ëŠ” ëŠë‚Œ','ê²¬ê°‘ê³¨ì„ ì¡°ì´ë©° ìˆ˜ì¶•í•œë‹¤','ë¤ë²¨ì„ ì—‰ë©ì´ ë°©í–¥ìœ¼ë¡œ ë‹¹ê¸´ë‹¤','ìƒì²´ê°€ íšŒì „í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜!']},'ë › í’€ë‹¤ìš´':{en:'Lat Pulldown',cat:'ë“±',start:['í—ˆë²…ì§€ë¥¼ íŒ¨ë“œ ì•„ë˜ì— ê³ ì •í•œë‹¤','ë„“ì€ ê·¸ë¦½(ì˜¤ë²„ê·¸ë¦½)ìœ¼ë¡œ ë°”ë¥¼ ì¡ëŠ”ë‹¤','ê°€ìŠ´ì„ í´ê³  ì•½ê°„ ë’¤ë¡œ ê¸°ìš¸ì¸ë‹¤','ì–´ê¹¨ë¥¼ ì•„ë˜ë¡œ ë‚´ë ¤ ê´‘ë°°ê·¼ í™œì„±í™”'],exec:['ë°”ë¥¼ ì‡„ê³¨(ê°€ìŠ´ ì•)ìœ¼ë¡œ ë‹¹ê¸´ë‹¤','ê²¬ê°‘ê³¨ì„ ì•„ë˜ë¡œ ë‹¹ê¸°ë©° ìˆ˜ì¶•','ì²œì²œíˆ ì˜¬ë ¤ ì™„ì „íˆ ìŠ¤íŠ¸ë ˆì¹­','ëª© ë’¤ë¡œ ë‹¹ê¸°ë©´ ì•ˆë¨! ê°€ìŠ´ ì•ìœ¼ë¡œ!']},'ì‹œí‹°ë“œ ì¼€ì´ë¸” ë¡œìš°':{en:'Seated Cable Row',cat:'ë“±',start:['ìƒì²´ëŠ” ë°”ë¥´ê²Œ ì„¸ìš°ê³  ì½”ì–´ì— í˜','ì†ì¡ì´ë¥¼ ì¡ëŠ”ë‹¤','ë°œì„ í’‹ í”Œë ˆì´íŠ¸ì— ë‹¨ë‹¨íˆ ë”›ëŠ”ë‹¤','ê°€ìŠ´ì„ í´ê³  ë“±ì„ ê³§ê²Œ ìœ ì§€'],exec:['ë°”ë¥¼ í•˜ë³µë¶€(ë°°ê¼½) ë°©í–¥ìœ¼ë¡œ ë‹¹ê¸´ë‹¤','ê²¬ê°‘ê³¨ì„ ëª¨ìœ¼ë©° ì–´ê¹¨ë¥¼ ë’¤ë¡œ','íŒ”ê¿ˆì¹˜ë¥¼ ëŒ€ê°ì„  ì•„ë˜ë¡œ ë‹¹ê²¨ì¤€ë‹¤','ìƒì²´ë¥¼ ê³¼ë„í•˜ê²Œ ì•ë’¤ë¡œ í”ë“¤ì§€ ì•Šê¸°!']},'í’€ì—…':{en:'Pull-Up',cat:'ë“±',start:['ì˜¤ë²„ê·¸ë¦½ìœ¼ë¡œ ì–´ê¹¨ë³´ë‹¤ ë„“ê²Œ ì¡ëŠ”ë‹¤','ì „ì‹ ì„ ëŠ˜ì–´ëœ¨ë¦° ë°ë“œí–‰ ìì„¸','ê²¬ê°‘ê³¨ì„ ì•„ë˜ë¡œ ë‹¹ê²¨ í™œì„±í™”','ì½”ì–´ì— í˜ì„ ì£¼ì–´ ëª¸ í”ë“¤ë¦¼ ë°©ì§€'],exec:['í„±ì´ ë°” ìœ„ë¡œ ì˜¬ë¼ì˜¬ ë•Œê¹Œì§€ ë‹¹ê¸´ë‹¤','íŒ”ê¿ˆì¹˜ë¥¼ ì•„ë˜ë¡œ ë‹¹ê¸´ë‹¤ëŠ” ëŠë‚Œ','ì²œì²œíˆ ë‚´ë ¤ì™€ ì™„ì „íˆ ìŠ¤íŠ¸ë ˆì¹­','ë°˜ë™ì„ ì“°ì§€ ë§ê³  ê·¼ìœ¡ í˜ìœ¼ë¡œë§Œ!']},'ë°ë“œë¦¬í”„íŠ¸':{en:'Conventional Deadlift',cat:'ë“±',start:['ë°œì„ ì—‰ë©ì´ ë„ˆë¹„ë¡œ, ë°”ì— ê°€ê¹ê²Œ ì„ ë‹¤','ì—‰ë©ì´ë¥¼ ë’¤ë¡œ ë°€ë©° ë°”ë¥¼ ì¡ëŠ”ë‹¤','ê°€ìŠ´ì„ í´ê³  í—ˆë¦¬ë¥¼ ê³§ê²Œ ìœ ì§€','ì–´ê¹¨ê°€ ë°” ë°”ë¡œ ìœ„ì— ìœ„ì¹˜'],exec:['ì—‰ë©ì´ì™€ ë¬´ë¦ì„ ë™ì‹œì— í´ë©° ì˜¬ë¦°ë‹¤','ë°”ëŠ” í•­ìƒ ëª¸ì— ê°€ê¹Œì´ ë¶™ì—¬ì•¼!','ì™„ì „íˆ ì„  ìì„¸ì—ì„œ ë‘”ê·¼ ìˆ˜ì¶•','í—ˆë¦¬ê°€ ì•„ë‹Œ ì—‰ë©ì´ì™€ ë‹¤ë¦¬ë¡œ ë“¤ì–´ì˜¬ë¦°ë‹¤']},'ë°”ë²¨ ì˜¤ë²„í—¤ë“œ í”„ë ˆìŠ¤':{en:'Barbell OHP',cat:'ì–´ê¹¨',start:['ë°”ë¥¼ ì‡„ê³¨ ì•(ì–´ê¹¨ ë†’ì´)ì—ì„œ ì¡ëŠ”ë‹¤','ë°œì€ ì–´ê¹¨ ë„ˆë¹„ë¡œ ë²Œë¦°ë‹¤','ì½”ì–´ì— í˜ì„ ì£¼ì–´ í—ˆë¦¬ ë³´í˜¸','íŒ”ê¿ˆì¹˜ë¥¼ ì‚´ì§ ì•ìœ¼ë¡œ ìœ„ì¹˜'],exec:['ë°”ë¥¼ ë¨¸ë¦¬ ìœ„ë¡œ ì§ì„ ìœ¼ë¡œ ë°€ì–´ ì˜¬ë¦°ë‹¤','ë°”ê°€ ì´ë§ˆ ì§€ë‚  ë•Œ ë¨¸ë¦¬ë¥¼ ì‚´ì§ ì•ìœ¼ë¡œ','íŒ”ì„ ì™„ì „íˆ í´ê³  ë°”ê°€ ê·€ ì˜†ì—','í—ˆë¦¬ë¥¼ ê³¼ë„í•˜ê²Œ ì –íˆì§€ ì•Šê¸°!']},'ë¤ë²¨ ìˆ„ë” í”„ë ˆìŠ¤':{en:'DB Shoulder Press',cat:'ì–´ê¹¨',start:['ë¤ë²¨ì„ ê·€ ë†’ì´ì—ì„œ ë“¤ê³  ì‹œì‘','ë“±ì„ ë²¤ì¹˜ì— ë°€ì°©','ì½”ì–´ì— í˜ì„ ì£¼ì–´ ì•ˆì •ì„± í™•ë³´','ì†ëª©ì€ ì¤‘ë¦½ ìœ ì§€'],exec:['ë¨¸ë¦¬ ìœ„ë¡œ ë°€ì–´ ì˜¬ë¦°ë‹¤','ìƒë‹¨ì—ì„œ ë¤ë²¨ì„ ì‚´ì§ ëª¨ì•„ì¤€ë‹¤','ì²œì²œíˆ ê·€ ë†’ì´ê¹Œì§€ ë‚´ë¦°ë‹¤','ë“±ì„ ê³¼ë„í•˜ê²Œ ì –íˆì§€ ì•Šê¸°!']},'ë¤ë²¨ ë˜í„°ëŸ´ ë ˆì´ì¦ˆ':{en:'Lateral Raise',cat:'ì–´ê¹¨',start:['ì–‘ì†ì— ê°€ë²¼ìš´ ë¤ë²¨ì„ ì¡ê³  ëª¸ ì˜†ì—','íŒ”ê¿ˆì¹˜ë¥¼ ì‚´ì§ êµ¬ë¶€ë¦° ìƒíƒœ ìœ ì§€','ìƒì²´ë¥¼ ì•½ê°„ ì•ìœ¼ë¡œ ê¸°ìš¸ì¸ë‹¤','ì–´ê¹¨ì— í˜ì„ ë¯¸ë¦¬ ëŠê»´ë‘”ë‹¤'],exec:['ì–‘íŒ”ì„ ì˜†ìœ¼ë¡œ ì–´ê¹¨ ë†’ì´ê¹Œì§€ ì˜¬ë¦°ë‹¤','ìƒˆë¼ì†ê°€ë½ì´ ì•½ê°„ ìœ„ë¥¼ í–¥í•˜ê²Œ','ë°˜ë™ì„ ì“°ì§€ ì•ŠëŠ”ë‹¤!','ì²œì²œíˆ ë‚´ë¦¬ë©° í…ì…˜ ìœ ì§€']},'í˜ì´ìŠ¤ í’€':{en:'Face Pull',cat:'ì–´ê¹¨',start:['ì¼€ì´ë¸”ì„ ëˆˆ ë†’ì´ì— ì„¤ì •','ë¡œí”„ë¥¼ ì–‘ì†ìœ¼ë¡œ ì¡ëŠ”ë‹¤','í•œ ë°œì„ ë’¤ë¡œ ë¹¼ê³  ì•ˆì • ìì„¸','ì–´ê¹¨ë¥¼ ë’¤ë¡œ ë‹¹ê²¨ í™œì„±í™”'],exec:['ë¡œí”„ë¥¼ ì–¼êµ´ ì–‘ì˜†ìœ¼ë¡œ ë‹¹ê¸´ë‹¤','íŒ”ê¿ˆì¹˜ë¥¼ ë’¤ë¡œ ë³´ë‚¸ë‹¤','ìµœëŒ€ ìˆ˜ì¶•ì—ì„œ ì™¸íšŒì „ ì¶”ê°€','ê°€ë²¼ìš´ ë¬´ê²Œ, ë§ì€ ë°˜ë³µì´ í•µì‹¬!']},'ì•„ë†€ë“œ í”„ë ˆìŠ¤':{en:'Arnold Press',cat:'ì–´ê¹¨',start:['ë¤ë²¨ì„ ì–´ê¹¨ ì•ì—ì„œ ì†ë°”ë‹¥ì´ ë‚˜ë¥¼ í–¥í•˜ê²Œ','íŒ”ê¿ˆì¹˜ë¥¼ ëª¸ ì•ì— ëª¨ì€ë‹¤','ë“±ì„ ê³§ê²Œ ì„¸ìš´ë‹¤','ì½”ì–´ì— í˜ì„ ì¤€ë‹¤'],exec:['ë°€ì–´ ì˜¬ë¦¬ë©° ì†ë°”ë‹¥ì´ ì•ì„ í–¥í•˜ë„ë¡ íšŒì „','ë¨¸ë¦¬ ìœ„ì—ì„œ ì™„ì „íˆ í¸ë‹¤','ì—­ë°©í–¥ìœ¼ë¡œ ëŒë¦¬ë©° ë‚´ë¦°ë‹¤','ë¶€ë“œëŸ¬ìš´ íšŒì „ì´ í•µì‹¬!']},'ë°”ë²¨ ë°± ìŠ¤ì¿¼íŠ¸':{en:'Back Squat',cat:'í•˜ì²´',start:['ë°”ë¥¼ ìŠ¹ëª¨ê·¼ ìœ„ì— ì˜¬ë¦°ë‹¤','ë°œì„ ì–´ê¹¨ ë„ˆë¹„, ë°œë ì•½ê°„ ë°”ê¹¥','ê°€ìŠ´ì„ í´ê³  ì½”ì–´ì— í˜ì„ ì¤€ë‹¤','ì‹œì„ ì€ ì „ë°© 2~3më¥¼ í–¥í•œë‹¤'],exec:['ì—‰ë©ì´ë¥¼ ë’¤ë¡œ ë¹¼ë©° ì•‰ëŠ”ë‹¤','í—ˆë²…ì§€ê°€ ìµœì†Œ ë°”ë‹¥ê³¼ í‰í–‰ê¹Œì§€','ë¬´ë¦ì´ ë°œë ë°©í–¥ì„ í–¥í•˜ë„ë¡!','ë°œë°”ë‹¥ ì „ì²´ë¡œ ë°€ì–´ ì˜¬ë¼ì˜¨ë‹¤']},'ë ˆê·¸ í”„ë ˆìŠ¤':{en:'Leg Press',cat:'í•˜ì²´',start:['ë“±ì„ íŒ¨ë“œì— ì™„ì „íˆ ë°€ì°©ì‹œí‚¨ë‹¤','ë°œì„ ë°œíŒì— ì–´ê¹¨ ë„ˆë¹„ë¡œ ì˜¬ë¦°ë‹¤','ë¬´ë¦ê³¼ ë°œëì´ ê°™ì€ ë°©í–¥','ì•ˆì „ì¥ì¹˜ë¥¼ í™•ì¸í•œë‹¤'],exec:['ë¬´ë¦ì´ 90ë„ê°€ ë  ë•Œê¹Œì§€ ë‚´ë¦°ë‹¤','ë°œë°”ë‹¥ ì „ì²´ë¡œ ë°€ì–´ ì˜¬ë¦°ë‹¤','ë¬´ë¦ì„ ì™„ì „íˆ ì ê·¸ì§€ ì•ŠëŠ”ë‹¤','ë°œ ìœ„ì¹˜ë¡œ ìê·¹ ë¶€ìœ„ ì¡°ì ˆ ê°€ëŠ¥']},'ë£¨ë§ˆë‹ˆì•ˆ ë°ë“œë¦¬í”„íŠ¸':{en:'Romanian DL',cat:'í•˜ì²´',start:['ë°”ë¥¼ ì–´ê¹¨ ë„ˆë¹„ë¡œ ì¡ê³  ë°”ë¡œ ì„ ë‹¤','ë¬´ë¦ì„ ì‚´ì§ êµ¬ë¶€ë¦° ì±„ ìœ ì§€','ê°€ìŠ´ì„ í´ê³  í—ˆë¦¬ë¥¼ ê³§ê²Œ','ì½”ì–´ì— í˜ì„ ì¤€ë‹¤'],exec:['ì—‰ë©ì´ë¥¼ ë’¤ë¡œ ë°€ë©° ìƒì²´ë¥¼ ìˆ™ì¸ë‹¤','ë°”ë¥¼ ë‹¤ë¦¬ì— ê°€ê¹ê²Œ ë¶™ì—¬ ë‚´ë¦°ë‹¤','í–„ìŠ¤íŠ¸ë§ ìŠ¤íŠ¸ë ˆì¹­ì„ ëŠë‚€ë‹¤','í—ˆë¦¬ë¥¼ ë‘¥ê¸€ê²Œ ë§ë©´ ì•ˆë¨!']},'ë°”ë²¨ í™ ì“°ëŸ¬ìŠ¤íŠ¸':{en:'Hip Thrust',cat:'í•˜ì²´',start:['ë“± ìƒë¶€ë¥¼ ë²¤ì¹˜ì— ê¸°ëŒ„ë‹¤','ë°”ë²¨ì„ ê³¨ë°˜ ìœ„ì— ì˜¬ë¦°ë‹¤','ë°œì„ ë°”ë‹¥ì— ë‹¨ë‹¨íˆ ë”›ëŠ”ë‹¤','í„±ì„ ë‹¹ê¸°ê³  ì‹œì„ ì„ ì•ìœ¼ë¡œ'],exec:['ì—‰ë©ì´ë¥¼ ìœ„ë¡œ ë°€ì–´ ì˜¬ë¦°ë‹¤','ìƒì²´ì™€ í—ˆë²…ì§€ê°€ ì¼ì§ì„ ì´ ë˜ë„ë¡','ìµœê³ ì ì—ì„œ ë‘”ê·¼ì„ ê°•í•˜ê²Œ ì¥ì–´ì§ ë‹¤','ì²œì²œíˆ ë‚´ë¦°ë‹¤']},'ë¶ˆê°€ë¦¬ì•ˆ ìŠ¤í”Œë¦¿ ìŠ¤ì¿¼íŠ¸':{en:'Bulgarian Split Squat',cat:'í•˜ì²´',start:['ë’·ë°œë“±ì„ ë²¤ì¹˜ì— ì˜¬ë ¤ë†“ëŠ”ë‹¤','ì•ë°œë¡œ ì²´ì¤‘ì„ ì§€íƒ±í•œë‹¤','ìƒì²´ë¥¼ ê³§ê²Œ ì„¸ìš´ë‹¤','ì½”ì–´ì— í˜ì„ ì¤€ë‹¤'],exec:['ì• í—ˆë²…ì§€ê°€ ë°”ë‹¥ê³¼ í‰í–‰ê¹Œì§€ ë‚´ë ¤ê°„ë‹¤','ì• ë¬´ë¦ì´ ë°œëì„ ë„˜ì§€ ì•Šë„ë¡','ì•ë°œë¡œ ë°€ì–´ ì˜¬ë¼ì˜¨ë‹¤','ê· í˜•ì„ ìœ ì§€í•˜ë©° ì²œì²œíˆ!']},'ë°”ë²¨ ì»¬':{en:'Barbell Curl',cat:'ì´ë‘',start:['ë°”ë¥¼ ì–´ê¹¨ ë„ˆë¹„ ì–¸ë”ê·¸ë¦½ìœ¼ë¡œ ì¡ëŠ”ë‹¤','íŒ”ê¿ˆì¹˜ë¥¼ ëª¸ ì˜†ì— ê³ ì •í•œë‹¤','ìƒì²´ë¥¼ ê³§ê²Œ ì„¸ìš´ë‹¤','ì–´ê¹¨ë¥¼ ì•„ë˜ë¡œ ë‚´ë ¤ ì•ˆì •ì‹œí‚¨ë‹¤'],exec:['ë°”ë¥¼ ì–´ê¹¨ ë†’ì´ê¹Œì§€ ì»¬í•œë‹¤','ì´ë‘ê·¼ ìˆ˜ì¶•ì„ ëŠë‚€ë‹¤','ì²œì²œíˆ ë‚´ë¦°ë‹¤','ë°˜ë™ ê¸ˆì§€!']},'í•´ë¨¸ ì»¬':{en:'Hammer Curl',cat:'ì´ë‘',start:['ë¤ë²¨ì„ ì†ë°”ë‹¥ì´ ë§ˆì£¼ ë³´ê²Œ ì¡ëŠ”ë‹¤','íŒ”ê¿ˆì¹˜ë¥¼ ëª¸ì— ê³ ì •','ìƒì²´ë¥¼ ê³§ê²Œ ì„¸ìš´ë‹¤','ì–´ê¹¨ëŠ” ìì—°ìŠ¤ëŸ½ê²Œ ë‚´ë¦°ë‹¤'],exec:['ì¤‘ë¦½ ê·¸ë¦½ ìœ ì§€í•˜ë©° ì»¬í•œë‹¤','íŒ”ê¿ˆì¹˜ê°€ ì•ìœ¼ë¡œ ë‚˜ì˜¤ì§€ ì•Šê²Œ','ì²œì²œíˆ ë‚´ë¦°ë‹¤','íŒ” ë‘ê»˜ë¥¼ í‚¤ìš°ëŠ” í•µì‹¬ ìš´ë™!']},'ì¼€ì´ë¸” í‘¸ì‹œë‹¤ìš´':{en:'Cable Pushdown',cat:'ì‚¼ë‘',start:['ë†’ì€ í’€ë¦¬ì— ë°”/ë¡œí”„ë¥¼ ë¶€ì°©','íŒ”ê¿ˆì¹˜ë¥¼ ëª¸ì— ê³ ì •í•œë‹¤','ìƒì²´ë¥¼ ì•½ê°„ ì•ìœ¼ë¡œ ê¸°ìš¸ì¸ë‹¤','ì–´ê¹¨ë¥¼ ë‚´ë ¤ ì•ˆì •ì‹œí‚¨ë‹¤'],exec:['ë°”ë¥¼ ì•„ë˜ë¡œ ë°€ì–´ íŒ”ì„ ì™„ì „íˆ í¸ë‹¤','ì‚¼ë‘ê·¼ ìˆ˜ì¶•ì„ ëŠë‚€ë‹¤','ì²œì²œíˆ ì˜¬ë¦°ë‹¤','ë¡œí”„: í•˜ë‹¨ì—ì„œ ì–‘ìª½ìœ¼ë¡œ ë²Œë¦¬ê¸°!']},'ìŠ¤ì»¬í¬ëŸ¬ì…”':{en:'Skull Crusher',cat:'ì‚¼ë‘',start:['ë²¤ì¹˜ì— ëˆ„ì›Œ EZë°”ë¥¼ ì¢ì€ ê·¸ë¦½ìœ¼ë¡œ','íŒ”ì„ í´ì„œ ë°”ë¥¼ ë“¤ì–´ì˜¬ë¦°ë‹¤','íŒ”ê¿ˆì¹˜ëŠ” ì–´ê¹¨ ë„ˆë¹„ë¡œ ê³ ì •','ê²¬ê°‘ê³¨ì„ ëª¨ì•„ ì•ˆì •ì  ê¸°ë°˜ í™•ë³´'],exec:['íŒ”ê¿ˆì¹˜ ê³ ì • í›„ ë°”ë¥¼ ì´ë§ˆìª½ìœ¼ë¡œ ë‚´ë¦°ë‹¤','ì‚¼ë‘ê·¼ ìŠ¤íŠ¸ë ˆì¹­ì„ ëŠë‚€ë‹¤','ì‚¼ë‘ê·¼ìœ¼ë¡œ ë°€ì–´ ì˜¬ë¦°ë‹¤','ë¨¸ë¦¬ ë’¤ìª½ìœ¼ë¡œ ë‚´ë¦¬ë©´ ì¥ë‘ ìê·¹ UP']},'ì¼€ì´ë¸” í¬ëŸ°ì¹˜':{en:'Cable Crunch',cat:'ì½”ì–´',start:['ë†’ì€ í’€ë¦¬ì— ë¡œí”„ë¥¼ ë¶€ì°©','ë¬´ë¦ì„ ê¿‡ê³  ë¡œí”„ë¥¼ ë¨¸ë¦¬ ì–‘ì˜†ì— ê³ ì •','ì—‰ë©ì´ ìœ„ì¹˜ë¥¼ ê³ ì •í•œë‹¤','ë³µê·¼ì— ë¯¸ë¦¬ í˜ì„ ëŠê»´ë‘”ë‹¤'],exec:['ë³µê·¼ì„ ìˆ˜ì¶•í•˜ë©° ë°”ë‹¥ìœ¼ë¡œ êµ¬ë¶€ë¦°ë‹¤','ì—‰ë©ì´ê°€ ì›€ì§ì´ë©´ ì•ˆëœë‹¤!','ì²œì²œíˆ ëŒì•„ì˜¨ë‹¤','ìˆœìˆ˜í•˜ê²Œ ë³µê·¼ìœ¼ë¡œë§Œ!']},'í–‰ì‰ ë ˆê·¸ ë ˆì´ì¦ˆ':{en:'Hanging Leg Raise',cat:'ì½”ì–´',start:['í’€ì—… ë°”ì— ë§¤ë‹¬ë¦°ë‹¤','ë‹¤ë¦¬ë¥¼ ëª¨ì€ë‹¤','ì–´ê¹¨ë¥¼ ì•„ë˜ë¡œ ë‹¹ê²¨ ì•ˆì •','ëª¸ í”ë“¤ë¦¼ì„ ìµœì†Œí™”í•œë‹¤'],exec:['ë³µê·¼ í˜ìœ¼ë¡œ ë‹¤ë¦¬ë¥¼ ë“¤ì–´ì˜¬ë¦°ë‹¤','ê°€ëŠ¥í•˜ë©´ ë°œëì´ ë°” ë†’ì´ê¹Œì§€','ì²œì²œíˆ ë‚´ë¦°ë‹¤','ë°˜ë™ ìµœì†Œí™”!']}};
const sel=document.getElementById('exSelect');let lc='';Object.keys(DB).forEach(n=>{const d=DB[n];if(d.cat!==lc){const og=document.createElement('optgroup');og.label=d.cat;sel.appendChild(og);lc=d.cat;}const o=document.createElement('option');o.value=n;o.textContent=n;sel.lastChild.appendChild(o);});
const CL='#e53935',CR='#1565C0';let ptsL=[],ptsR=[],idC=0;
function nid(){return 'p'+(++idC);}
function toast(msg){const t=document.getElementById('toast');t.textContent=msg;t.className='toast show';setTimeout(()=>t.className='toast',2500);}

// â•â•â• API â•â•â•
async function apiCall(data){try{const res=await fetch(API_URL,{method:'POST',headers:{'Content-Type':'text/plain'},body:JSON.stringify(data)});return await res.json();}catch(err){return {success:false,error:err.message};}}
let allMembers=[];
async function loadMembers(){
  document.getElementById('memberStatus').textContent='ë¡œë”©ì¤‘...';
  try{const res=await fetch(API_URL+'?action=get_members');const data=await res.json();
  if(data.success){
    allMembers=data.members;
    document.getElementById('memberStatus').textContent=allMembers.length+'ëª…';
  }}
  catch(err){document.getElementById('memberStatus').textContent='ì˜¤í”„ë¼ì¸';}
}
function refreshMembers(){
  toast('ğŸ“¥ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...');
  const cur=document.getElementById('selectedMember').value;
  loadMembers().then(()=>{
    // Check if currently selected member still exists
    if(cur && !allMembers.find(m=>m.name===cur)){
      document.getElementById('selectedMember').value='';
      document.getElementById('memberSearch').value='';
      document.getElementById('delMemberBtn').style.display='none';
      document.getElementById('historyBar').classList.remove('show');
      toast('âš ï¸ '+cur+' íšŒì›ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
    } else {
      toast('âœ… ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ!');
    }
  });
}
function filterMembers(){
  const q=document.getElementById('memberSearch').value.trim().toLowerCase();
  const dd=document.getElementById('memberDropdown');
  dd.innerHTML='';
  const filtered=q?allMembers.filter(m=>m.name.toLowerCase().includes(q)):allMembers;
  if(filtered.length===0){
    dd.innerHTML='<div class="member-item" style="color:#888;cursor:default;">ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ</div>';
  } else {
    filtered.forEach(m=>{
      const item=document.createElement('div');
      item.className='member-item';
      item.innerHTML=m.name+'<span class="mi-sessions">'+(m.totalSessions||0)+'íšŒì°¨</span>';
      // Use mousedown + touchend for iPad compatibility (fires before blur)
      item.addEventListener('mousedown',function(e){e.preventDefault();selectMember(m.name);});
      item.addEventListener('touchend',function(e){e.preventDefault();selectMember(m.name);});
      dd.appendChild(item);
    });
  }
  dd.classList.add('show');
}
function showMemberDropdown(){
  filterMembers();
}
function selectMember(name){
  document.getElementById('memberSearch').value=name;
  document.getElementById('selectedMember').value=name;
  document.getElementById('memberDropdown').classList.remove('show');
  document.getElementById('memberStatus').textContent=name;
  document.getElementById('delMemberBtn').style.display='';
  loadLogs(name);
}
// Close dropdown when clicking outside
document.addEventListener('click',function(e){
  if(!e.target.closest('.member-bar')){
    document.getElementById('memberDropdown').classList.remove('show');
  }
});
function onMemberChange(){
  const name=document.getElementById('selectedMember').value;
  if(name){loadLogs(name);}
  else{document.getElementById('historyBar').classList.remove('show');}
}
async function promptAddMember(){
  document.getElementById('modalTitle').textContent='ìƒˆ íšŒì› ë“±ë¡';
  document.getElementById('modalInput').value='';
  document.getElementById('modalInput').placeholder='íšŒì› ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”';
  document.getElementById('modalOk').textContent='ë“±ë¡';
  document.getElementById('modalOk').style.background='#00d4aa';
  currentModalAction='add';
  document.getElementById('modal').classList.add('show');
  setTimeout(()=>document.getElementById('modalInput').focus(),100);
}
function promptDeleteMember(){
  const name=document.getElementById('selectedMember').value;
  if(!name){toast('âš ï¸ íšŒì›ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”!');return;}
  document.getElementById('confirmModal').querySelector('.modal-title').textContent='ğŸ—‘ íšŒì› ì‚­ì œ';
  document.getElementById('confirmModal').querySelector('p').textContent=name+' íšŒì›ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\ní•´ë‹¹ íšŒì›ì˜ ëª¨ë“  ì¼ì§€ê°€ ì‚­ì œë©ë‹ˆë‹¤.';
  const okBtn=document.getElementById('confirmModal').querySelectorAll('.modal-btn')[1];
  okBtn.textContent='ì‚­ì œ';
  okBtn.style.background='#e53935';
  okBtn.onclick=async()=>{
    closeConfirm();
    toast('â³ ì‚­ì œì¤‘...');
    const res=await apiCall({action:'delete_member',member:name});
    if(res.success){
      toast('âœ… '+name+' ì‚­ì œ ì™„ë£Œ!');
      document.getElementById('selectedMember').value='';
      document.getElementById('memberSearch').value='';
      document.getElementById('delMemberBtn').style.display='none';
      document.getElementById('historyBar').classList.remove('show');
      loadMembers();
    }else{toast('âŒ '+(res.error||'ì‹¤íŒ¨'));}
    resetConfirmModal();
  };
  document.getElementById('confirmModal').classList.add('show');
}
function resetConfirmModal(){
  const okBtn=document.getElementById('confirmModal').querySelectorAll('.modal-btn')[1];
  okBtn.textContent='ìƒˆ ì¼ì§€ ì‹œì‘';okBtn.style.background='#00d4aa';okBtn.onclick=()=>confirmNewPage();
  document.getElementById('confirmModal').querySelector('.modal-title').textContent='ğŸ“„ ìƒˆ ì¼ì§€ ë§Œë“¤ê¸°';
  document.getElementById('confirmModal').querySelector('p').textContent='í˜„ì¬ ì¼ì§€ë¥¼ ì´ˆê¸°í™”í•˜ê³  ìƒˆ ì¼ì§€ë¥¼ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?';
}
let currentModalAction='add';
function closeModal(){document.getElementById('modal').classList.remove('show');}
async function modalConfirm(){
  const name=document.getElementById('modalInput').value.trim();
  if(!name){toast('âš ï¸ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”!');return;}
  closeModal();
  toast('â³ ë“±ë¡ì¤‘...');
  const res=await apiCall({action:'add_member',member:name});
  if(res.success){toast('âœ… '+name+' ë“±ë¡!');loadMembers();selectMember(name);}
  else{toast('âŒ '+(res.error||'ì‹¤íŒ¨'));}
}

// â•â•â• HISTORY â•â•â•
let logCache={};
let currentSessionIndex=-1; // -1 means new session, 0+ means editing existing
async function loadLogs(name){
  try{const res=await fetch(API_URL+'?action=get_logs&member='+encodeURIComponent(name));const data=await res.json();
  if(data.success){
    const sessions=[];let cur=null;
    data.logs.forEach(row=>{
      const d=String(row.date||'');
      if(d.indexOf('â”€â”€â”€â”€')>=0){
        // Extract date from "â”€â”€â”€â”€ 2/19 â”€â”€â”€â”€"
        const dateStr=d.replace(/â”€/g,'').trim();
        cur={date:dateStr,exercises:[],teachingPoints:[],tpName:'',
             sleep:row.sleep||'',supplement:row.supplement||'',
             warmup:row.warmup||'',cooldown:row.cooldown||''};
        sessions.push(cur);
      }else if(cur && d.indexOf('[Teaching Point')>=0){
        // Extract exercise name from "[Teaching Point - ë°”ë²¨ í”Œë« ë²¤ì¹˜í”„ë ˆìŠ¤]"
        cur.tpName=d.replace('[Teaching Point - ','').replace(']','').trim();
      }else if(cur && d.indexOf('â†’')>=0){
        cur.teachingPoints.push(d.replace(/^\s*â†’\s*/,''));
      }else if(cur && row.exercise){
        cur.exercises.push({name:row.exercise,kg:row.kg,setReps:row.setReps});
      }
    });
    logCache[name]=sessions;
    renderHistory(sessions);
  }}catch(err){console.error(err);}
}
function renderHistory(sessions){
  const bar=document.getElementById('historyBar');
  const list=document.getElementById('histList');
  list.innerHTML='';
  bar.classList.add('show');
  if(sessions.length===0){
    list.innerHTML='<span style="color:#888;font-size:11px;">ì €ì¥ëœ ì¼ì§€ê°€ ì—†ìŠµë‹ˆë‹¤</span>';
    return;
  }
  sessions.forEach((s,i)=>{
    const wrap=document.createElement('div');
    wrap.style.cssText='display:flex;align-items:center;gap:2px;flex-shrink:0;';
    const chip=document.createElement('button');
    chip.className='hist-chip';
    chip.textContent=(i+1)+'íšŒì°¨ ('+s.date+')';
    chip.onclick=()=>loadSession(s,i,chip);
    wrap.appendChild(chip);
    const del=document.createElement('button');
    del.style.cssText='width:20px;height:20px;border-radius:50%;border:1px solid #555;background:transparent;color:#888;font-size:10px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;';
    del.textContent='âœ•';
    del.onmouseover=()=>{del.style.background='#e53935';del.style.color='white';del.style.borderColor='#e53935';};
    del.onmouseout=()=>{del.style.background='transparent';del.style.color='#888';del.style.borderColor='#555';};
    del.onclick=(e)=>{e.stopPropagation();deleteSession(i);};
    wrap.appendChild(del);
    list.appendChild(wrap);
  });
}
function loadSession(s,idx,chip){
  document.querySelectorAll('.hist-chip').forEach(c=>c.classList.remove('active'));
  chip.classList.add('active');
  // Fill date
  document.getElementById('dateCell').textContent=s.date;
  // Fill info fields
  document.getElementById('sleepCell').textContent=s.sleep||'';
  document.getElementById('suppCell').textContent=s.supplement||'';
  document.getElementById('warmupCell').textContent=s.warmup||'';
  document.getElementById('cooldownCell').textContent=s.cooldown||'';
  // Fill exercises
  const rows=document.getElementById('exB').querySelectorAll('tr');
  rows.forEach(r=>{r.querySelectorAll('td').forEach(c=>{c.textContent='';});});
  s.exercises.forEach((ex,i)=>{
    if(i>=document.getElementById('exB').querySelectorAll('tr').length) addExRow();
    const allRows=document.getElementById('exB').querySelectorAll('tr');
    if(i<allRows.length){
      const cells=allRows[i].querySelectorAll('td');
      cells[0].textContent=ex.name;cells[1].textContent=ex.kg;cells[2].textContent=ex.setReps;
    }
  });
  // Restore exercise selection
  if(s.tpName){
    const selEl=document.getElementById('exSelect');
    for(let i=0;i<selEl.options.length;i++){
      if(selEl.options[i].value===s.tpName){selEl.value=s.tpName;break;}
    }
    document.getElementById('exNameEn').textContent=(DB[s.tpName]||{}).en||'';
  }
  // Restore teaching points
  if(s.teachingPoints&&s.teachingPoints.length>0){
    const startPts=[];const execPts=[];
    s.teachingPoints.forEach(tp=>{
      if(tp.startsWith('[ì‹œì‘] ')) startPts.push(tp.replace('[ì‹œì‘] ',''));
      else if(tp.startsWith('[ìˆ˜í–‰] ')) execPts.push(tp.replace('[ìˆ˜í–‰] ',''));
      else startPts.push(tp);
    });
    ptsL=startPts.map((t,i)=>({id:nid(),text:t,dotX:50+(i%2)*10,dotY:15+i*22,lblX:3,lblY:5+i*24}));
    ptsR=execPts.map((t,i)=>({id:nid(),text:t,dotX:50+(i%2)*10,dotY:15+i*22,lblX:3,lblY:5+i*24}));
  } else if(s.tpName && DB[s.tpName]){
    // No saved TPs but exercise name exists - load from DB
    const d=DB[s.tpName];
    ptsL=d.start.map((t,i)=>({id:nid(),text:t,dotX:50+(i%2)*10,dotY:15+i*22,lblX:3,lblY:5+i*24}));
    ptsR=d.exec.map((t,i)=>({id:nid(),text:t,dotX:50+(i%2)*10,dotY:15+i*22,lblX:3,lblY:5+i*24}));
  } else {
    ptsL=[];ptsR=[];
  }
  renderAnns('L');renderAnns('R');renderCues();
  currentSessionIndex=idx;
  document.getElementById('saveBtn').textContent='ğŸ’¾ '+(idx+1)+'íšŒì°¨ ì €ì¥';
  toast('ğŸ“‹ '+(idx+1)+'íšŒì°¨ ë¶ˆëŸ¬ì˜´');
}
// â•â•â• DELETE SESSION â•â•â•
function deleteSession(idx){
  const member=document.getElementById('selectedMember').value;
  if(!member)return;
  // Show confirm modal for delete
  document.getElementById('confirmModal').querySelector('.modal-title').textContent='ğŸ—‘ ì¼ì§€ ì‚­ì œ';
  document.getElementById('confirmModal').querySelector('p').textContent=(idx+1)+'íšŒì°¨ ì¼ì§€ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?';
  const okBtn=document.getElementById('confirmModal').querySelectorAll('.modal-btn')[1];
  okBtn.textContent='ì‚­ì œ';
  okBtn.style.background='#e53935';
  okBtn.onclick=async()=>{
    closeConfirm();
    toast('â³ ì‚­ì œì¤‘...');
    const res=await apiCall({action:'delete_log',member:member,sessionIndex:idx});
    if(res.success){toast('âœ… ì‚­ì œ ì™„ë£Œ!');loadLogs(member);}
    else{toast('âŒ '+(res.error||'ì‹¤íŒ¨'));}
    resetConfirmModal();
  };
  document.getElementById('confirmModal').classList.add('show');
}

// â•â•â• SAVE â•â•â•
async function saveToSheet(){
  const member=document.getElementById('selectedMember').value;
  if(!member){toast('âš ï¸ íšŒì›ì„ ì„ íƒí•˜ì„¸ìš”!');return;}
  const date=document.getElementById('dateCell').textContent.trim();
  if(!date){toast('âš ï¸ ë‚ ì§œë¥¼ ì…ë ¥í•˜ì„¸ìš”!');return;}
  const btn=document.getElementById('saveBtn');btn.textContent='â³ ì €ì¥ì¤‘...';btn.classList.add('saving');
  const rows=document.getElementById('exB').querySelectorAll('tr');const exercises=[];
  rows.forEach(r=>{const cells=r.querySelectorAll('td');const name=(cells[0]||{}).textContent?.trim();if(name)exercises.push({name,kg:(cells[1]||{}).textContent?.trim(),setReps:(cells[2]||{}).textContent?.trim()});});
  const tps=[];ptsL.forEach(p=>tps.push('[ì‹œì‘] '+p.text));ptsR.forEach(p=>tps.push('[ìˆ˜í–‰] '+p.text));
  const payload={member,date,sleep:document.getElementById('sleepCell').textContent.trim(),supplement:document.getElementById('suppCell').textContent.trim(),warmup:document.getElementById('warmupCell').textContent.trim(),cooldown:document.getElementById('cooldownCell').textContent.trim(),exerciseName:document.getElementById('exSelect').value,exercises,teachingPoints:tps};
  
  if(currentSessionIndex>=0){
    // Update existing session
    payload.action='update_log';
    payload.sessionIndex=currentSessionIndex;
  } else {
    // New session
    payload.action='save_log';
  }
  
  const res=await apiCall(payload);
  if(res.success){
    const label=currentSessionIndex>=0?(currentSessionIndex+1)+'íšŒì°¨ ìˆ˜ì • ì™„ë£Œ!':'ìƒˆ ì¼ì§€ ì €ì¥ ì™„ë£Œ!';
    toast('âœ… '+label);
    loadLogs(member);
  }else{toast('âŒ '+(res.error||'ì‹¤íŒ¨'));}
  btn.textContent='ğŸ’¾ ì €ì¥';btn.classList.remove('saving');
}

// â•â•â• NEW PAGE â•â•â•
function newPage(){
  document.getElementById('confirmModal').classList.add('show');
}
function closeConfirm(){document.getElementById('confirmModal').classList.remove('show');}
function confirmNewPage(){
  closeConfirm();
  document.getElementById('dateCell').textContent=getTodayStr();
  document.getElementById('sleepCell').textContent='';
  document.getElementById('suppCell').textContent='';
  document.getElementById('warmupCell').textContent='';
  document.getElementById('cooldownCell').textContent='';
  document.getElementById('memoBox').textContent='';
  document.getElementById('exSelect').value='';
  document.getElementById('exNameEn').textContent='';
  // Clear exercises
  const rows=document.getElementById('exB').querySelectorAll('tr');
  rows.forEach(r=>{r.querySelectorAll('td').forEach(c=>{c.textContent='';});});
  // Clear photos
  removePhoto('L');removePhoto('R');
  // Clear points
  ptsL=[];ptsR=[];
  document.getElementById('cues').style.display='none';
  document.getElementById('cuesContent').innerHTML='';
  // Clear checkboxes
  document.querySelectorAll('.bp input[type=checkbox]').forEach(c=>c.checked=false);
  // Clear hydration
  document.querySelectorAll('.h-dot').forEach(d=>d.classList.remove('filled'));
  // Clear session marks
  document.querySelectorAll('.session-num').forEach(s=>s.classList.remove('marked'));
  // Clear history highlight
  document.querySelectorAll('.hist-chip').forEach(c=>c.classList.remove('active'));
  // Reset to new session mode
  currentSessionIndex=-1;
  document.getElementById('saveBtn').textContent='ğŸ’¾ ìƒˆ ì¼ì§€ ì €ì¥';
  toast('ğŸ“„ ìƒˆ ì¼ì§€ê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤!');
}

// â•â•â• PHOTO REMOVE â•â•â•
function removePhoto(side){
  const img=document.getElementById('img'+side);
  const upl=document.getElementById('upl'+side);
  const rm=document.getElementById('rm'+side);
  const fileInput=document.getElementById('file'+side);
  img.style.display='none';img.src='';
  upl.style.display='';
  rm.classList.remove('show');
  fileInput.value='';
  // Clear annotations on this side
  const panel=document.getElementById('panel'+side);
  panel.querySelectorAll('.ann,.dot').forEach(el=>el.remove());
  document.getElementById('svg'+side).innerHTML='';
}

// â•â•â• Teaching Points â•â•â•
function onSelectExercise(){const n=sel.value;if(!n)return;const d=DB[n];document.getElementById('exNameEn').textContent=d.en;ptsL=d.start.map((t,i)=>({id:nid(),text:t,dotX:50+(i%2)*10,dotY:15+i*22,lblX:3,lblY:5+i*24}));ptsR=d.exec.map((t,i)=>({id:nid(),text:t,dotX:50+(i%2)*10,dotY:15+i*22,lblX:3,lblY:5+i*24}));renderAnns('L');renderAnns('R');renderCues();}
function loadImg(s,e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=ev=>{const img=document.getElementById('img'+s);img.onload=()=>{img.style.display='block';document.getElementById('upl'+s).style.display='none';document.getElementById('rm'+s).classList.add('show');renderAnns(s);renderCues();};img.src=ev.target.result;};r.readAsDataURL(f);}
function renderAnns(s){const p=document.getElementById('panel'+s),sv=document.getElementById('svg'+s),pts=s==='L'?ptsL:ptsR,c=s==='L'?CL:CR;p.querySelectorAll('.ann,.dot').forEach(e=>e.remove());sv.innerHTML='';pts.forEach((pt,i)=>{const l=document.createElement('div');l.className='ann';l.style.borderColor=c;l.style.color=c;l.style.left=pt.lblX+'%';l.style.top=pt.lblY+'%';l.dataset.id=pt.id;l.dataset.side=s;l.innerHTML='<span class="n" style="background:'+c+'">'+(i+1)+'</span><span class="ann-txt">'+pt.text+'</span><button class="del-ann" onclick="delPt(\''+s+'\',\''+pt.id+'\')">âœ•</button>';mkD(l,pt,'lbl',s);p.appendChild(l);const d=document.createElement('div');d.className='dot';d.style.background=c;d.style.left=pt.dotX+'%';d.style.top=pt.dotY+'%';mkD(d,pt,'dot',s);p.appendChild(d);const ln=document.createElementNS('http://www.w3.org/2000/svg','line');ln.id='ln-'+pt.id;ln.setAttribute('x1',pt.lblX+'%');ln.setAttribute('y1',pt.lblY+'%');ln.setAttribute('x2',pt.dotX+'%');ln.setAttribute('y2',pt.dotY+'%');ln.setAttribute('stroke',c);ln.setAttribute('stroke-width','1.5');ln.setAttribute('stroke-opacity','0.6');sv.appendChild(ln);});}
function mkD(el,pt,t,s){let sx,sy,spx,spy;function st(e){if(document.body.classList.contains('capture'))return;e.preventDefault();e.stopPropagation();const tc=e.touches?e.touches[0]:e;sx=tc.clientX;sy=tc.clientY;spx=t==='dot'?pt.dotX:pt.lblX;spy=t==='dot'?pt.dotY:pt.lblY;function mv(ev){ev.preventDefault();const m=ev.touches?ev.touches[0]:ev;const r=document.getElementById('panel'+s).getBoundingClientRect();const dx=((m.clientX-sx)/r.width)*100,dy=((m.clientY-sy)/r.height)*100;let nx=Math.max(0,Math.min(95,spx+dx)),ny=Math.max(0,Math.min(95,spy+dy));if(t==='dot'){pt.dotX=nx;pt.dotY=ny;}else{pt.lblX=nx;pt.lblY=ny;}el.style.left=nx+'%';el.style.top=ny+'%';const ln=document.getElementById('ln-'+pt.id);if(ln){ln.setAttribute('x1',pt.lblX+'%');ln.setAttribute('y1',pt.lblY+'%');ln.setAttribute('x2',pt.dotX+'%');ln.setAttribute('y2',pt.dotY+'%');}}function en(){document.removeEventListener('mousemove',mv);document.removeEventListener('mouseup',en);document.removeEventListener('touchmove',mv);document.removeEventListener('touchend',en);}document.addEventListener('mousemove',mv,{passive:false});document.addEventListener('mouseup',en);document.addEventListener('touchmove',mv,{passive:false});document.addEventListener('touchend',en);}el.addEventListener('mousedown',st);el.addEventListener('touchstart',st,{passive:false});}
function delPt(s,id){if(s==='L')ptsL=ptsL.filter(p=>p.id!==id);else ptsR=ptsR.filter(p=>p.id!==id);renderAnns(s);renderCues();}
function addPt(s){const pts=s==='L'?ptsL:ptsR;pts.push({id:nid(),text:'ìƒˆ í¬ì¸íŠ¸ ì…ë ¥',dotX:50,dotY:50,lblX:10,lblY:10+pts.length*20});renderAnns(s);renderCues();}
function renderCues(){document.getElementById('cues').style.display='block';const c=document.getElementById('cuesContent');c.innerHTML='';const sL=document.createElement('div');sL.className='cues-sub-row';sL.innerHTML='<span class="cues-sub" style="color:'+CL+'">â–ì‹œì‘ ìì„¸ (START)</span><button class="add-cue-btn" onclick="addPt(\'L\')">ï¼‹ ì¶”ê°€</button>';c.appendChild(sL);ptsL.forEach((p,i)=>{const r=document.createElement('div');r.className='cue';r.innerHTML='<div class="cn" style="background:'+CL+'">'+(i+1)+'</div><input class="cue-text" value="'+p.text+'" oninput="upTxt(\'L\',\''+p.id+'\',this.value)"/><button class="cue-del" onclick="delPt(\'L\',\''+p.id+'\')">âœ•</button>';c.appendChild(r);});const sR=document.createElement('div');sR.className='cues-sub-row';sR.innerHTML='<span class="cues-sub" style="color:'+CR+'">â–ìˆ˜í–‰ ìì„¸ (EXECUTION)</span><button class="add-cue-btn" onclick="addPt(\'R\')">ï¼‹ ì¶”ê°€</button>';c.appendChild(sR);ptsR.forEach((p,i)=>{const r=document.createElement('div');r.className='cue';r.innerHTML='<div class="cn" style="background:'+CR+'">'+(i+1)+'</div><input class="cue-text" value="'+p.text+'" oninput="upTxt(\'R\',\''+p.id+'\',this.value)"/><button class="cue-del" onclick="delPt(\'R\',\''+p.id+'\')">âœ•</button>';c.appendChild(r);});}
function upTxt(s,id,v){const pts=s==='L'?ptsL:ptsR;const p=pts.find(x=>x.id===id);if(p){p.text=v;const panel=document.getElementById('panel'+s);const a=panel.querySelector('.ann[data-id="'+id+'"] .ann-txt');if(a)a.textContent=v;}}

// â•â•â• CAPTURE â•â•â•
async function captureAndSave(){
  const btn=document.getElementById('capBtn');
  btn.textContent='â³ ì €ì¥ì¤‘...';btn.classList.add('saving');
  document.body.classList.add('capture');
  document.getElementById('toolbar').style.display='none';
  
  // Replace cue-text inputs with spans for capture (html2canvas clips inputs)
  const cueInputs=document.querySelectorAll('.cue-text');
  const originals=[];
  cueInputs.forEach(inp=>{
    const span=document.createElement('span');
    span.className='cue-text-snap';
    span.style.cssText='font-size:11px;color:#444;font-weight:500;flex:1;padding:1px 2px;';
    span.textContent=inp.value;
    originals.push({inp,parent:inp.parentNode,next:inp.nextSibling});
    inp.parentNode.replaceChild(span,inp);
  });
  
  await new Promise(r=>setTimeout(r,300));
  try{
    const sheet=document.getElementById('sheet');
    const canvas=await html2canvas(sheet,{scale:2,useCORS:true,backgroundColor:'#ffffff',logging:false});
    canvas.toBlob(function(blob){
      const url=URL.createObjectURL(blob);
      const link=document.createElement('a');
      const d=new Date();
      const fn='PTì¼ì§€_'+d.getFullYear()+String(d.getMonth()+1).padStart(2,'0')+String(d.getDate()).padStart(2,'0')+'_'+String(d.getHours()).padStart(2,'0')+String(d.getMinutes()).padStart(2,'0')+'.png';
      link.href=url;link.download=fn;document.body.appendChild(link);link.click();document.body.removeChild(link);
      if(navigator.share&&navigator.canShare){const file=new File([blob],fn,{type:'image/png'});if(navigator.canShare({files:[file]})){navigator.share({files:[file],title:'PT ì¼ì§€'}).catch(()=>{});}}
      setTimeout(()=>URL.revokeObjectURL(url),5000);
      toast('âœ… ì´ë¯¸ì§€ ì €ì¥!');
    },'image/png',1.0);
  }catch(err){toast('âŒ ìº¡ì²˜ ì‹¤íŒ¨');}
  
  // Restore inputs
  originals.forEach(({inp,parent,next})=>{
    const snap=parent.querySelector('.cue-text-snap');
    if(snap) parent.replaceChild(inp,snap);
  });
  
  document.body.classList.remove('capture');
  document.getElementById('toolbar').style.display='flex';
  btn.textContent='ğŸ“¸ ìº¡ì²˜';btn.classList.remove('saving');
}

// â•â•â• INIT â•â•â•
function getTodayStr(){const d=new Date();return(d.getMonth()+1)+'/'+d.getDate();}
const sgEl=document.getElementById('sg');for(let i=1;i<=40;i++){const d=document.createElement('div');d.className='session-num';d.textContent=i;d.style.cursor='pointer';d.onclick=()=>d.classList.toggle('marked');sgEl.appendChild(d);}
const hrc=document.getElementById('hr');for(let i=0;i<8;i++){const d=document.createElement('div');d.className='h-dot';d.onclick=()=>{hrc.querySelectorAll('.h-dot').forEach((x,j)=>x.classList.toggle('filled',j<=i));};hrc.appendChild(d);}
function addExRow(){const b=document.getElementById('exB');const r=document.createElement('tr');r.innerHTML='<td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>';b.appendChild(r);}
document.getElementById('dateCell').textContent=getTodayStr();
loadMembers();
</script>
</body>
</html>
